# ============================================================================
# CRITICAL SECURITY - REQUIRED ENVIRONMENT VARIABLES
# ============================================================================
# Copy this file to .env and fill in all values
# NEVER commit the actual .env file to version control!

# ============================================================================
# JWT Configuration (CRITICAL - NO DEFAULT!)
# ============================================================================
JWT_SECRET_KEY=your-super-secure-secret-key-here-at-least-32-chars-CHANGE-ME
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# Super Admin Setup (One-time use - CHANGE IMMEDIATELY AFTER FIRST USE)
# ============================================================================
SUPER_ADMIN_SETUP_KEY=your-super-admin-setup-key-change-immediately-CHANGE-ME

# ============================================================================
# Google OAuth
# ============================================================================
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/oauth-callback/google

# ============================================================================
# GitHub OAuth
# ============================================================================
# Get credentials from: https://github.com/settings/developers
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_REDIRECT_URI=http://localhost:3000/auth/oauth-callback/github

# ============================================================================
# Email OTP (SMTP Configuration)
# ============================================================================
# For Gmail, use app password: https://support.google.com/accounts/answer/185833
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@brainsait-rcm.com

# ============================================================================
# Twilio (SMS + WhatsApp OTP)
# ============================================================================
# Get credentials from: https://www.twilio.com/console
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890
TWILIO_WHATSAPP_NUMBER=+1234567890

# ============================================================================
# MongoDB Configuration (Already exists)
# ============================================================================
DATABASE_URL=mongodb+srv://username:password@cluster.mongodb.net/brainsait?retryWrites=true&w=majority
MONGODB_SERVER_SELECTION_TIMEOUT_MS=5000
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=1
MONGODB_TLS=true

# ============================================================================
# CORS Configuration
# ============================================================================
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
ALLOW_CREDENTIALS=true

# ============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ============================================================================
# Before deploying to production:
# 
# 1. Generate strong JWT_SECRET_KEY (at least 32 random characters)
#    Example: openssl rand -hex 32
#
# 2. Generate strong SUPER_ADMIN_SETUP_KEY (at least 32 random characters)
#    Example: openssl rand -hex 32
#
# 3. Set up Google OAuth:
#    - Create project: https://console.cloud.google.com/
#    - Enable Google+ API
#    - Create OAuth 2.0 credentials
#    - Add authorized redirect URIs
#
# 4. Set up GitHub OAuth:
#    - Register app: https://github.com/settings/developers
#    - Set Homepage URL and Authorization callback URL
#
# 5. Configure SMTP for email OTP:
#    - For Gmail, enable 2FA and create app password
#    - Or use service like SendGrid, AWS SES, Mailgun
#
# 6. Set up Twilio for SMS/WhatsApp:
#    - Create account: https://www.twilio.com/
#    - Buy phone number for SMS
#    - Request WhatsApp Business API access
#
# 7. Update CORS origins to match your production domains
#
# 8. After creating first super admin:
#    - Delete or rotate SUPER_ADMIN_SETUP_KEY immediately
#    - Document the super admin email securely
#
# 9. Set up monitoring and alerts for:
#    - Failed login attempts
#    - Rate limit violations
#    - OAuth failures
#    - OTP delivery failures
#
# 10. Regular security practices:
#     - Rotate JWT_SECRET_KEY every 90 days
#     - Monitor auth_events collection for suspicious activity
#     - Review and update dependencies monthly
#     - Backup MongoDB regularly
